syntax = "proto3";
package acmain.iam.v1;

import "acmain/iam/v1/enums.proto";
import "amino/amino.proto";
import "gogoproto/gogo.proto";
import "google/protobuf/timestamp.proto";

option go_package = "acmain/x/iam/types";

// CredentialProof represents the cryptographic proof of a verifiable credential
message CredentialProof {
  option (amino.name) = "acmain/x/iam/CredentialProof";

  // type is the proof type (e.g., "Ed25519Signature2020")
  string type = 1;

  // created_at is when the proof was created
  google.protobuf.Timestamp created_at = 2 [
    (gogoproto.stdtime) = true,
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];

  // verification_method is the DID method used to verify (e.g., "#key-1")
  string verification_method = 3;

  // proof_value is the signature bytes (base64 encoded in JSON)
  bytes proof_value = 4;
}

// CredentialSubject represents the subject of a verifiable credential
message CredentialSubject {
  option (amino.name) = "acmain/x/iam/CredentialSubject";

  // id is the DID of the subject
  string id = 1;

  // claims are key-value attribute pairs (e.g., "role": "engineer", "department": "ops")
  map<string, string> claims = 2;
}

// CredentialStatusInfo tracks the status of a credential
message CredentialStatusInfo {
  option (amino.name) = "acmain/x/iam/CredentialStatusInfo";

  // status is the current status of the credential
  CredentialStatus status = 1;

  // updated_at is when the status was last updated
  google.protobuf.Timestamp updated_at = 2 [
    (gogoproto.stdtime) = true,
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];

  // revocation_reason describes why the credential was revoked/suspended
  string revocation_reason = 3;
}
