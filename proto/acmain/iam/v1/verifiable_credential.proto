syntax = "proto3";
package acmain.iam.v1;

import "acmain/iam/v1/credential.proto";
import "acmain/iam/v1/enums.proto";
import "amino/amino.proto";
import "cosmos_proto/cosmos.proto";
import "gogoproto/gogo.proto";
import "google/protobuf/timestamp.proto";

option go_package = "acmain/x/iam/types";

// VerifiableCredential represents a W3C Verifiable Credential
message VerifiableCredential {
  option (amino.name) = "acmain/x/iam/VerifiableCredential";

  // id is the unique identifier for this credential
  string id = 1;

  // context defines the JSON-LD context
  repeated string context = 2;

  // type specifies credential types (always includes "VerifiableCredential")
  repeated string type = 3;

  // issuer is the address/DID that issued this credential
  string issuer = 4 [(cosmos_proto.scalar) = "cosmos.AddressString"];

  // issued_at is the block timestamp when credential was issued
  google.protobuf.Timestamp issued_at = 5 [
    (gogoproto.stdtime) = true,
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];

  // credential_subject is the subject and their claims
  CredentialSubject credential_subject = 6 [
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];

  // valid_from is the earliest time the credential is valid
  google.protobuf.Timestamp valid_from = 7 [(gogoproto.stdtime) = true];

  // valid_until is the expiration time of the credential
  google.protobuf.Timestamp valid_until = 8 [(gogoproto.stdtime) = true];

  // credential_status tracks revocation/suspension
  CredentialStatusInfo credential_status = 9;

  // proof is the cryptographic proof of the credential
  CredentialProof proof = 10 [
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];

  // credential_type is the semantic type of the credential
  CredentialType credential_type = 11;

  // holder is the DID of the entity that holds this credential
  string holder = 12;

  // metadata stores additional issuer-specific attributes
  map<string, string> metadata = 13;

  // refresh_service enables credential renewal
  string refresh_service = 14;
}
