syntax = "proto3";
package acmain.iam.v1;

import "acmain/iam/v1/enums.proto";
import "amino/amino.proto";
import "cosmos_proto/cosmos.proto";
import "gogoproto/gogo.proto";
import "google/protobuf/timestamp.proto";

option go_package = "acmain/x/iam/types";

// DeviceKey represents a registered device's public key information
message DeviceKey {
  option (amino.name) = "acmain/x/iam/DeviceKey";

  // device_id is the unique identifier for the IoT device
  string device_id = 1;

  // public_key is the device's public key
  bytes public_key = 2;

  // key_type is the cryptographic algorithm
  KeyType key_type = 3;

  // owner is the Cosmos address that owns this device
  string owner = 4 [(cosmos_proto.scalar) = "cosmos.AddressString"];

  // device_type describes the device category (e.g., "smart_lock", "sensor", "witness_node")
  string device_type = 5;

  // location is where the device is physically located
  string location = 6;

  // registered_at is the block timestamp of registration
  google.protobuf.Timestamp registered_at = 7 [
    (gogoproto.stdtime) = true,
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];

  // last_rotation_at is the timestamp of last key rotation
  google.protobuf.Timestamp last_rotation_at = 8 [(gogoproto.stdtime) = true];

  // revoked_at indicates if/when the key was revoked
  google.protobuf.Timestamp revoked_at = 9 [(gogoproto.stdtime) = true];

  // metadata stores device-specific attributes
  map<string, string> metadata = 10;

  // active indicates if the device key is currently active
  bool active = 11;
}
